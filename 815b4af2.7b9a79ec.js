(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{71:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return p}));var r=n(2),i=n(6),a=(n(0),n(85)),l={id:"api1",title:"API Guide",sidebar_label:"API Guide"},o={unversionedId:"apis/api1",id:"apis/api1",isDocsHomePage:!1,title:"API Guide",description:"Introduction",source:"@site/docs/apis/api1.md",permalink:"/docs/apis/api1",editUrl:"https://github.com/Intilery/intilery.github.io/edit/master/website/docs/apis/api1.md",sidebar_label:"API Guide",sidebar:"apis"},c=[{value:"Introduction",id:"introduction",children:[]},{value:"API Overview",id:"api-overview",children:[{value:"Endpoint",id:"endpoint",children:[]},{value:"Headers",id:"headers",children:[]}]}],u={rightToc:c};function p(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"introduction"},"Introduction"),Object(a.b)("p",null,"The Intilery Event API lets you record customer data from any website or application."),Object(a.b)("p",null,"In order to track events or issue commands against a customer, the customer must be first be identified to the system using an identify event which will add the customer to the Intilery CDP."),Object(a.b)("h2",{id:"api-overview"},"API Overview"),Object(a.b)("h3",{id:"endpoint"},"Endpoint"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"https://tracking.intilery.com/track/{clientId}/{accountId}/{BRANDID}/v1/{action}")),Object(a.b)("p",null,"You will be given you clientId, accountIds and brandIDs."),Object(a.b)("p",null,"The endpoint expects a POST of JSON data."),Object(a.b)("p",null,"Authentication is via a shared secret passed in the auth-token header."),Object(a.b)("p",null,"The actions are detailed below."),Object(a.b)("h3",{id:"headers"},"Headers"),Object(a.b)("h4",{id:"content-type"},"Content-Type"),Object(a.b)("p",null,"You must provide a content-type header of application/json"),Object(a.b)("h4",{id:"auth-token"},"Auth-Token"),Object(a.b)("p",null,"Authentication to handled by a shared secret that must be passed in a header"),Object(a.b)("h4",{id:"example-request"},"Example Request"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell",metastring:"script",script:!0}),'curl "https://tracking.intilery.com/track/hea/hea/HEA/v1/{action}" -i -X POST \\\n-H "content-type: application/json" \\\n-H "auth-token: 1234abcd" \\\n-d @event.json\n')),Object(a.b)("h4",{id:"permissions"},"Permissions"),Object(a.b)("p",null,"Your Authentication token will be set with permissions at the Account and Brand level, token\u2019s can be created that have access to all Brands within an Account or a token for each Brand (and account)."),Object(a.b)("h4",{id:"limits"},"Limits"),Object(a.b)("p",null,"The API is set to 100 requests per second with a burst of 500, limit and burst explained here"),Object(a.b)("p",null,"If limits are exceeded you will receive a 429 Error (limit exceeded) response."),Object(a.b)("p",null,"The maximum size of any request is 6mb, exceeding this will return a 413 Error."),Object(a.b)("h4",{id:"response"},"Response"),Object(a.b)("p",null,"The API will respond with the appropriate HTTP response code, along with a body in the form of: -"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),'{\n    "success": true,\n    "eventId": "7f7211bf-94c8-4bfc-afb2-8a319d045cd6"\n}\n')),Object(a.b)("p",null,"The eventID is a unique ID that is passed to all systems within the platform, this eventID can be used to query the status of the request (event) and receive any errors that occur"),Object(a.b)("p",null,"Response Error Codes"),Object(a.b)("p",null,"403 "),Object(a.b)("p",null,"No Token Supplied"),Object(a.b)("p",null,"403 "),Object(a.b)("p",null,"Token Not Authorised (for the Account/Brand you are trying to access)"),Object(a.b)("p",null,"429"),Object(a.b)("p",null,"Rate limit exceeded (there is a limit of 100 request/second, with a burst to 500)"),Object(a.b)("p",null,"413"),Object(a.b)("p",null,"Request to large (there is a maximum size of 6Mb for a request)"),Object(a.b)("p",null,"502"),Object(a.b)("p",null,"API returned an invalid response"),Object(a.b)("p",null,"503"),Object(a.b)("p",null,"API Unavailable"),Object(a.b)("p",null,"504"),Object(a.b)("p",null,"API timed out"),Object(a.b)("p",null,"Identify Action"),Object(a.b)("p",null,"identify\xa0lets you tie a user to their actions and record traits about them. It includes a unique User ID and any optional traits you know about them."),Object(a.b)("p",null,"We recommend calling\xa0identify\xa0a single time when the user\u2019s account is first created, and only identifying again later when their traits change."),Object(a.b)("p",null,"POST ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://tracking.intilery.com/track/%7BclientId%7D/%7BaccountId%7D/%7BBRANDID%7D/v1/identify"}),"https://tracking.intilery.com/track/{clientId}/{accountId}/{BRANDID}/v1/identify")),Object(a.b)("p",null,'{\n"userId": "ABC/123",\n"event":"identify",\n"traits": {\n"marketingPreferences": {\n"channels": ','[\n{\n"channel": "email",\n"subscribed": true\n} ,\n{\n"channel": "sms",\n"subscribed": true\n},\n{\n"channel": "whatsapp",\n"subscribed": true\n},\n{\n"channel": "facebook",\n"subscribed": true\n},\n{\n"channel": "push",\n"subscribed": true\n}\n]','\n},\n"clientReference": "ABC/123",\n"email": "',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"mailto:email@example.com"}),"email@example.com"),'",\n"title": "Mr",\n"firstName": "Fred",\n"lastName": "Flintsonte",\n"phone": "+44123456789",\n"address": {\n"houseNumberOrName": "56",\n"addressLine1": "A Road",\n"addressLine2": "Chester",\n"addressLine3": "Cheshire",\n"postalCode": "CH1ABC"\n}\n},\n"context": {\n"ip": "24.5.68.47"\n},\n"timestamp": "2019-11-18T13:30:11.444Z"\n}'),Object(a.b)("p",null,"This call is identifying the user by their unique User ID (the one you know him by in your database) and setting their traits (attributes) with the values supplied."),Object(a.b)("p",null,"Traits can be any valid JSON."),Object(a.b)("p",null,"userId"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"Unique identifier for the user in your database"),Object(a.b)("p",null,"event"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"must be \u201cidentify\u201d"),Object(a.b)("p",null,"traits"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"Free-form dictionary of traits of the user, like email or firstName or an object like address"),Object(a.b)("p",null,"timestamp"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"ISO-8601 UTC Timestamp (e.g. 2019-11-18T13:30:11.444Z)"),Object(a.b)("p",null,"context"),Object(a.b)("p",null,"optional"),Object(a.b)("p",null,"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like ip address or locale"),Object(a.b)("p",null,"Track Action"),Object(a.b)("p",null,"track\xa0lets you record the actions your users perform, record analytics for them or issue commands. Every action triggers what we call an \u201cevent\u201d, which can also have associated properties."),Object(a.b)("p",null,"You\u2019ll want to track events that are indicators of success for your site, like\xa0registered,\xa0item purchased\xa0or\xa0logged in."),Object(a.b)("p",null,"To get started, we recommend tracking just a few important events. You can always add more later!"),Object(a.b)("p",null,"POST ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://tracking.intilery.com/track/%7BclientID%7D/%7Baccountid%7D/%7BBRANDID%7D/v1/track"}),"https://tracking.intilery.com/track/{clientID}/{accountid}/{BRANDID}/v1/track")),Object(a.b)("p",null,"Example added to basket event"),Object(a.b)("p",null,'{\n"userId":"ABC/123",\n"event":"Product Added",\n"context":{\n"page":{\n"path":"/simplygosimplygo-pure-inulin/p-19868604-44086200",\n"referrer":"",\n"search":"",\n"title":"Simplygo/simplygo-pure-inulin | Fruugo",\n"url":"',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200%22"}),'https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200"'),'\n},\n"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"\n},\n"properties":{\n"name":"Simplygo/simplygo-pure-inulin",\n"product_id":"p-19868604-44086200",\n"price":"\xa311.99",\n"cart_id":"1234",\n"image_url":"',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://img.fruugo.com/product/3/55/98531553_max.jpg%22"}),'https://img.fruugo.com/product/3/55/98531553_max.jpg"'),',\n"quantity":"1",\n"url":"',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200%22"}),'https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200"'),'\n},\n"timestamp":"2019-11-28T14:31:58.596Z"\n}'),Object(a.b)("p",null,"userId"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"Unique identifier for the user in your database"),Object(a.b)("p",null,"event"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"Name of the action that a user has performed."),Object(a.b)("p",null,"timestamp"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"ISO-8601 UTC Timestamp (e.g. 2019-11-18T13:30:11.444Z) for then the event happened"),Object(a.b)("p",null,"properties"),Object(a.b)("p",null,"optional"),Object(a.b)("p",null,"Free-form dictionary of properties of the event, like price or sku"),Object(a.b)("p",null,"context"),Object(a.b)("p",null,"optional"),Object(a.b)("p",null,"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like page or userAgent"),Object(a.b)("p",null,"The track endpoint can also be used to pass specific   to trigger campaign sends."),Object(a.b)("p",null,"Page Action"),Object(a.b)("p",null,"The\xa0page\xa0action lets you record page views on your website, along with optional extra information about the page being viewed. The JavaScript tag will raise a page event whenever a new page is loaded."),Object(a.b)("p",null,"POST ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://tracking.intilery.com/track/%7BclientID%7D/%7Baccountid%7D/%7BBRANDID%7D/v1/page"}),"https://tracking.intilery.com/track/{clientID}/{accountid}/{BRANDID}/v1/page")),Object(a.b)("p",null,"Example\xa0page\xa0call:"),Object(a.b)("p",null,'{\n"event":"page",\n"userId":"ABC/123",\n"anonymousId":"14834fb6-e82e-47f9-a7e0-892c45064d89",\n"context":{\n"page":{\n"path":"/simplygosimplygo-pure-inulin/p-19868604-44086200",\n"referrer":"",\n"search":"",\n"title":"Simplygo/simplygo-pure-inulin | Fruugo",\n"url":"',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200%22"}),'https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200"'),'\n},\n"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36",\n"properties":{\n"path":"/simplygosimplygo-pure-inulin/p-19868604-44086200",\n"referrer":"",\n"search":"",\n"title":"Simplygo/simplygo-pure-inulin | Fruugo",\n"url":"',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200%22"}),'https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200"'),'\n},\n"timestamp":"2019-11-28T14:50:16.519Z"\n}'),Object(a.b)("p",null,"userId"),Object(a.b)("p",null,"optional*"),Object(a.b)("p",null,"Unique identifier for the user in your database. If not known, you must pass anonymousId"),Object(a.b)("p",null,"anonymousId"),Object(a.b)("p",null,"optional*"),Object(a.b)("p",null,"A pseudo-unique substitute for a userId, for cases when you don't know who the customer is at present."),Object(a.b)("p",null,"event"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"must be \u201cpage\u201d"),Object(a.b)("p",null,"timestamp"),Object(a.b)("p",null,"required"),Object(a.b)("p",null,"ISO-8601 UTC Timestamp (e.g. 2019-11-18T13:30:11.444Z) for then the event happened"),Object(a.b)("p",null,"properties"),Object(a.b)("p",null,"optional"),Object(a.b)("p",null,"Free-form dictionary of properties of the event, like price or sku"),Object(a.b)("p",null,"context"),Object(a.b)("p",null,"optional"),Object(a.b)("p",null,"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like page or userAgent"))}p.isMDXComponent=!0},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return m}));var r=n(0),i=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u=i.a.createContext({}),p=function(e){var t=i.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=p(e.components);return i.a.createElement(u.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},d=i.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),s=p(n),d=r,m=s["".concat(l,".").concat(d)]||s[d]||b[d]||a;return n?i.a.createElement(m,o(o({ref:t},u),{},{components:n})):i.a.createElement(m,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=d;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<a;u++)l[u]=n[u];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);